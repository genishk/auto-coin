name: Coin Signal Check (4H Dual)

on:
  # 4ì‹œê°„ë§ˆë‹¤ ìë™ ì‹¤í–‰ (UTC ê¸°ì¤€)
  # UTC 0, 4, 8, 12, 16, 20ì‹œ = ë‰´ìš• 7PM, 11PM, 3AM, 7AM, 11AM, 3PM
  schedule:
    - cron: '15 0,4,8,12,16,20 * * *'  # ë§¤ 4ì‹œê°„ë´‰ ë§ˆê° 15ë¶„ í›„
  
  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥ (í…ŒìŠ¤íŠ¸ìš©)
  workflow_dispatch:

jobs:
  check-signals:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Run dual signal check
      id: signal_check
      run: python scripts/check_4h_dual.py
    
    - name: Send email notification
      if: steps.signal_check.outputs.signal_type != 'none'
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}
        subject: |
          ${{ steps.signal_check.outputs.signal_type == 'long_entry' && 'ğŸŸ¢ BTC ë¡± ì§„ì…!' || 
              steps.signal_check.outputs.signal_type == 'long_exit' && 'ğŸŸ¡ BTC ë¡± ì²­ì‚°!' || 
              steps.signal_check.outputs.signal_type == 'short_entry' && 'ğŸ”´ BTC ìˆ ì§„ì…!' || 
              steps.signal_check.outputs.signal_type == 'short_exit' && 'ğŸŸ¡ BTC ìˆ ì²­ì‚°!' || 
              'â‚¿ BTC ì‹œê·¸ë„' }} - Dual 4H (${{ steps.signal_check.outputs.current_time }})
        to: ${{ secrets.EMAIL_TO }}
        from: Auto-Coin Dual <${{ secrets.EMAIL_USERNAME }}>
        body: |
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ”„ Auto-Coin ë¡±/ìˆ ë“€ì–¼ 4ì‹œê°„ë´‰ ë¦¬í¬íŠ¸
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

          ğŸ“… ì‹œê°„: ${{ steps.signal_check.outputs.current_time }} (UTC)

          ğŸ’° ê°€ê²© ì •ë³´ (4ì‹œê°„ë´‰)
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          ì‹œê°€: $${{ steps.signal_check.outputs.open_price }}
          ê³ ê°€: $${{ steps.signal_check.outputs.high_price }}
          ì €ê°€: $${{ steps.signal_check.outputs.low_price }}
          ì¢…ê°€: $${{ steps.signal_check.outputs.close_price }}

          ğŸ“ˆ ê¸°ìˆ  ì§€í‘œ
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          RSI: ${{ steps.signal_check.outputs.current_rsi }}
          MA100: $${{ steps.signal_check.outputs.ma100 }}
          MA200: $${{ steps.signal_check.outputs.ma200 }}
          ì¶”ì„¸: ${{ steps.signal_check.outputs.trend == 'GC' && 'ğŸŸ¢ ìƒìŠ¹ì¥ (ê³¨ë“ í¬ë¡œìŠ¤)' || 'ğŸ”´ í•˜ë½ì¥ (ë°ë“œí¬ë¡œìŠ¤)' }}

          ğŸš¨ ì‹œê·¸ë„
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          ${{ steps.signal_check.outputs.signal_type == 'long_entry' && format('ğŸŸ¢ ë¡± ì§„ì… ì‹œê·¸ë„!\n   RSI ê³¼ë§¤ë„ íƒˆì¶œ + ê³¨ë“ í¬ë¡œìŠ¤\n   ì§„ì… ê°€ê²©: ${0}', steps.signal_check.outputs.signal_price) || 
              steps.signal_check.outputs.signal_type == 'long_exit' && format('ğŸŸ¡ ë¡± ì²­ì‚° ì‹œê·¸ë„!\n   RSI ê³¼ë§¤ìˆ˜ í›„ í•˜ë½\n   ì²­ì‚° ê°€ê²©: ${0}', steps.signal_check.outputs.signal_price) || 
              steps.signal_check.outputs.signal_type == 'short_entry' && format('ğŸ”´ ìˆ ì§„ì… ì‹œê·¸ë„!\n   {0}\n   ì§„ì… ê°€ê²©: ${1}', steps.signal_check.outputs.trend == 'GC' && 'RSI peak í›„ í•˜í–¥' || 'DC RSI 55 í•˜í–¥', steps.signal_check.outputs.signal_price) || 
              steps.signal_check.outputs.signal_type == 'short_exit' && format('ğŸŸ¡ ìˆ ì²­ì‚° ì‹œê·¸ë„!\n   RSI ê³¼ë§¤ë„ íƒˆì¶œ\n   ì²­ì‚° ê°€ê²©: ${0}', steps.signal_check.outputs.signal_price) || 
              'ğŸ“­ ì‹œê·¸ë„ ì—†ìŒ' }}

          ğŸ“‹ ì „ëµ (í•˜ë½ì¥ ë°©ì–´ ìµœì í™”)
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          â€¢ ë¡±: RSI<35â†’40 íƒˆì¶œ + GC(MA100>MA200)
          â€¢ ìˆ (GC): RSI 78+ í›„ 65 í•˜í–¥
          â€¢ ìˆ (DC): RSI 55 í•˜í–¥ ëŒíŒŒ
          â€¢ ì†ì ˆ: ë¡± -25%, ìˆ -15%

          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ëŒ€ì‹œë³´ë“œ: streamlit run dashboard_4h_dual.py
          GitHub: https://github.com/genishk/auto-coin

